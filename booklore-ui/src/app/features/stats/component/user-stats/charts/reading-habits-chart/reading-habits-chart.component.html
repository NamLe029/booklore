<div class="reading-habits-container">
  <div class="chart-header">
    <div class="chart-title">
      <h3>
        <i class="pi pi-chart-line reading-habits-icon"></i>
        Reading Habits Analysis
        <i class="pi pi-question-circle chart-info-icon"
           pTooltip="A radar chart analyzing your reading behavior across 8 dimensions. Consistency measures regularity of completions over time. Completionism tracks finish vs. abandonment rate. Methodology checks if you read series in order. Scores are derived from your reading activity, dates, and progress data."
           tooltipPosition="bottom"
           tooltipStyleClass="chart-info-tooltip"
           [appendTo]="'body'"></i>
      </h3>
      <p class="chart-description">Your behavioral reading patterns across 8 dimensions</p>
    </div>
  </div>
  <div class="chart-wrapper">
    <canvas baseChart
            [data]="(chartData$ | async) ?? {labels: [], datasets: []}"
            [options]="chartOptions"
            [type]="chartType">
    </canvas>
  </div>
  @if (habitInsights.length > 0) {
    <div class="habit-insights">
      <h4>Your Reading Habit Patterns</h4>
      <div class="insights-grid">
        @for (insight of habitInsights; track insight.habit) {
          <div class="insight-card">
            <div class="insight-header">
              <span class="insight-trait">{{ insight.habit }}</span>
              <span class="insight-score" [style.color]="insight.color">{{ insight.score.toFixed(0) }}%</span>
            </div>
            <div class="insight-progress">
              <div class="progress-bar" [style.width.%]="insight.score" [style.background-color]="insight.color"></div>
            </div>
            <p class="insight-description">{{ insight.description }}</p>
          </div>
        }
      </div>
    </div>
  }
</div>
